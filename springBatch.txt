import org.springframework.batch.item.database.builder.JdbcBatchItemWriterBuilder;
import org.springframework.jdbc.core.namedparam.MapSqlParameterSource;
import org.springframework.jdbc.core.namedparam.SqlParameterSource;

@Bean
public ItemWriter<Map<String, Object>> itemWriter(DataSource dataSource) {
    System.out.println("inside itemWriter: " + dataSource);
    return new JdbcBatchItemWriterBuilder<Map<String, Object>>()
        .itemSqlParameterSourceProvider(this::mapToSqlParameterSource)
        .sql("INSERT INTO your_table_name (column1, column2, column3) VALUES (:column1, :column2, :column3)")
        .dataSource(dataSource)
        .build();
}

private SqlParameterSource mapToSqlParameterSource(Map<String, Object> item) {
    MapSqlParameterSource parameterSource = new MapSqlParameterSource();
    item.forEach(parameterSource::addValue);
    return parameterSource;
}
